name: dorothy
description: Deployment Orchestrator - Knows how to deploy and manage bots
version: 0.1.0

server:
  host: 0.0.0.0
  # port is read from chester/config.yaml via shared/config/ports.py

deployment:
  default_server: prod
  default_ssl_email: admin@watsonblinds.com.au  # Can override with SSL_EMAIL env var
  deployment_timeout: 600  # 10 minutes
  verification_checks:
    - nginx_config
    - gunicorn_service
    - ssl_certificate
    - repository
    - virtualenv
    - permissions

# Dependencies: Other bots that Dorothy requires to function
dependencies:
  - sally    # SSH command executor - required for deployments
  - chester  # Bot configuration database - required for bot configs

services:
  chester:
    # Base URL â€“ dev vs prod is handled by env var
    base_url: ${CHESTER_URL:-http://localhost:8008}
    deployment_bots_path: /api/deployment/bots
    manage_ui_path: /manage

  sally:
    # Only if Dorothy actually calls Sally directly via HTTP
    base_url: ${SALLY_URL:-http://localhost:8004}
    internal_only: true

# NOTE: Bot deployment configurations are managed exclusively by Chester.
# Dorothy queries Chester's API to get bot configs.
#
# To manage bot configurations:
#   - Use Chester's web UI: http://localhost:8008/manage
#   - Use Chester's REST API: POST /api/deployment/bots
#
# Chester must be running for Dorothy to retrieve bot configurations.
# There is no local fallback - Chester is the single source of truth.
