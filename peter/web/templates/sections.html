{% extends "base.html" %}

{% block content %}
<div class="card">
    <h2>Manage Sections</h2>

    <p style="margin-bottom: 20px; color: #7f8c8d;">
        Sections help organize your staff directory. Add new sections here, and they'll appear as options when adding or editing staff.
    </p>

    {% if error %}
    <div class="error">
        <strong>Error:</strong> {{ error }}
    </div>
    {% endif %}

    <form method="POST" action="/sections/add" style="margin-bottom: 30px; padding: 20px; background: #f8f9fa; border-radius: 4px;">
        <div style="display: flex; gap: 10px; align-items: flex-end;">
            <div style="flex: 1;">
                <label for="name">Section Name</label>
                <input type="text" id="name" name="name" required placeholder="e.g., Sales, Admin, Warehouse">
            </div>
            <button type="submit" class="btn">Add Section</button>
        </div>
    </form>

    {% if sections %}
    <table>
        <thead>
            <tr>
                <th style="width: 60px;">Order</th>
                <th>Section Name</th>
                <th style="width: 150px;">Created</th>
                <th style="width: 120px;">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for section in sections %}
            <tr>
                <td style="text-align: center;">{{ section.display_order }}</td>
                <td><strong>{{ section.name }}</strong></td>
                <td>{{ section.created_date[:10] }}</td>
                <td>
                    <a href="/sections/{{ section.id }}/edit" class="btn btn-small" style="background: #3498db; margin-right: 5px;">Edit</a>
                    <form method="POST" action="/sections/{{ section.id }}/delete" style="display: inline;" class="confirm-form">
                        <button type="button" class="btn btn-danger btn-small confirm-trigger">Delete</button>
                        <span class="confirm-state" style="display: none;">
                            <button type="submit" class="btn btn-danger btn-small">Yes</button>
                            <button type="button" class="btn btn-small cancel-confirm" style="background: #95a5a6;">No</button>
                        </span>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty-state">
        <h3>No sections yet</h3>
        <p>Add your first section above. Sections are automatically populated when you import from Google Sheets.</p>
    </div>
    {% endif %}
</div>

<div style="margin-top: 20px;">
    <a href="/" class="btn" style="background: #95a5a6;">Back to Directory</a>
</div>

<script>
    // Confirmation pattern for destructive actions
    document.addEventListener('click', function(e) {
        if (e.target.classList.contains('confirm-trigger')) {
            const form = e.target.closest('.confirm-form');
            e.target.style.display = 'none';
            form.querySelector('.confirm-state').style.display = 'inline';
        }
        if (e.target.classList.contains('cancel-confirm')) {
            const form = e.target.closest('.confirm-form');
            form.querySelector('.confirm-state').style.display = 'none';
            form.querySelector('.confirm-trigger').style.display = '';
        }
    });
</script>
{% endblock %}
