{% extends "base.html" %}

{% block content %}
<div class="card">
    <h2>Manage Sections</h2>

    <p style="margin-bottom: 20px; color: #7f8c8d;">
        Sections help organize your staff directory. Add new sections here, and they'll appear as options when adding or editing staff.
    </p>

    {% if error %}
    <div class="error">
        <strong>Error:</strong> {{ error }}
    </div>
    {% endif %}

    <form method="POST" action="/sections/add" style="margin-bottom: 30px; padding: 20px; background: #f8f9fa; border-radius: 4px;">
        <div style="display: flex; gap: 10px; align-items: flex-end;">
            <div style="flex: 1;">
                <label for="name">Section Name</label>
                <input type="text" id="name" name="name" required placeholder="e.g., SALES, ADMIN, WAREHOUSE">
            </div>
            <button type="submit" class="btn">Add Section</button>
        </div>
    </form>

    <div style="margin-bottom: 20px; padding: 15px; background: #d5f4e6; border-left: 4px solid #27ae60; border-radius: 4px;">
        <p style="margin: 0; color: #2c3e50;">
            <strong>Tip:</strong> If you have staff already in the database, you can auto-populate sections from their data.
            <form method="POST" action="/sections/auto-populate" style="display: inline; margin-left: 10px;">
                <button type="submit" class="btn btn-small" style="background: #27ae60;">
                    Auto-Populate from Staff
                </button>
            </form>
        </p>
    </div>

    {% if sections %}
    <table>
        <thead>
            <tr>
                <th style="width: 60px;">Order</th>
                <th>Section Name</th>
                <th style="width: 150px;">Created</th>
                <th style="width: 120px;">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for section in sections %}
            <tr>
                <td style="text-align: center;">{{ section.display_order }}</td>
                <td><strong>{{ section.name }}</strong></td>
                <td>{{ section.created_date[:10] }}</td>
                <td>
                    <form method="POST" action="/sections/{{ section.id }}/delete" style="display: inline;">
                        <button type="submit" class="btn btn-danger btn-small"
                                onclick="return confirm('Delete section {{ section.name }}? This only works if no staff are assigned to it.')">
                            Delete
                        </button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty-state">
        <h3>No sections yet</h3>
        <p>You can add sections manually above, or auto-populate from your existing staff.</p>
        <form method="POST" action="/sections/auto-populate" style="margin-top: 20px;">
            <button type="submit" class="btn" style="background: #27ae60;">
                Auto-Populate from Staff
            </button>
        </form>
    </div>
    {% endif %}
</div>

<div style="margin-top: 20px;">
    <a href="/" class="btn" style="background: #95a5a6;">Back to Directory</a>
</div>
{% endblock %}
