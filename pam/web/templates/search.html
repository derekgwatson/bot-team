{% extends "base.html" %}

{% block content %}
<div class="search-bar">
    <form action="/search" method="GET">
        <input type="search" name="q" value="{{ query }}" placeholder="Search by name, position, or extension..." autocomplete="off" autofocus data-lpignore="true" data-form-type="other">
        <button type="submit">Search</button>
    </form>
</div>

{% if error %}
<div class="error">
    <strong>Error:</strong> {{ error }}
</div>
{% endif %}

{% if query %}
    <div style="margin-bottom: 20px; color: #666;">
        {% if sections %}
        Showing results for <strong>"{{ query }}"</strong>
        {% else %}
        No results found for <strong>"{{ query }}"</strong>
        {% endif %}
    </div>
{% endif %}

{% if sections %}
    {% for section_name, contacts in sections.items() %}
    <div class="section-header">{{ section_name }}</div>

    <div class="contacts-grid">
        {% for contact in contacts %}
        <div class="contact-card">
            <div class="contact-header">
                <div class="contact-name-section">
                    <div class="contact-name">{{ contact.name }}</div>
                    {% if contact.position %}
                    <div class="contact-position">{{ contact.position }}</div>
                    {% endif %}
                </div>
                {% if contact.extension %}
                <div class="contact-ext">
                    <span class="badge">{{ contact.extension }}</span>
                </div>
                {% endif %}
            </div>

            <div class="contact-details">
                {% if contact.fixed_line %}
                <div class="contact-detail-line">
                    <span class="icon">üìû</span>
                    <a href="tel:{{ contact.fixed_line }}">{{ contact.fixed_line }}</a>
                </div>
                {% endif %}
                {% if contact.mobile %}
                <div class="contact-detail-line">
                    <span class="icon">üì±</span>
                    <a href="tel:{{ contact.mobile }}">{{ contact.mobile }}</a>
                </div>
                {% endif %}
                {% if contact.email %}
                <div class="contact-detail-line">
                    <span class="icon">‚úâÔ∏è</span>
                    <a href="mailto:{{ contact.email }}">{{ contact.email }}</a>
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% endfor %}
{% elif not query %}
<div class="empty-state">
    <h3>Search the Directory</h3>
    <p>Enter a name, position, or extension to find someone.</p>
</div>
{% endif %}
{% endblock %}
